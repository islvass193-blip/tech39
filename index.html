<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TechCase ‚Ä¢ –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ | –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥</title>
<style>
:root {
    --primary: #6366f1;
    --secondary: #8b5cf6;
    --bg: #0f0f23;
    --bg-card: rgba(15,15,35,0.9);
    --text: #f8fafc;
    --accent: #10b981;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, var(--bg), #1e1b4b); color: var(--text); min-height: 100vh; }
header { background: rgba(0,0,0,0.8); backdrop-filter: blur(20px); padding: 1rem 2rem; position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
.logo { font-size: 1.8rem; font-weight: bold; background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
nav ul { display: flex; list-style: none; gap: 2rem; flex-wrap: wrap; }
nav a { color: var(--text); text-decoration: none; padding: 0.5rem 1rem; border-radius: 50px; transition: all 0.3s; }
nav a:hover, nav a.active { background: var(--primary); }
.auth-cart { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
.cart-btn, .auth-btn { background: var(--bg-card); border: 1px solid var(--primary); padding: 0.5rem 1rem; border-radius: 50px; cursor: pointer; transition: all 0.3s; }
.cart-btn:hover { background: var(--accent); }
.profile { background: var(--accent); color: #000; padding: 0.5rem 1rem; border-radius: 50px; }
main { max-width: 1400px; margin: 2rem auto; padding: 0 2rem; }
.hero { text-align: center; margin-bottom: 3rem; }
.hero h1 { font-size: 3rem; margin-bottom: 1rem; background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.products-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; }
.product { background: var(--bg-card); border-radius: 20px; padding: 1.5rem; text-align: center; transition: transform 0.3s, box-shadow 0.3s; border: 1px solid rgba(99,102,241,0.2); }
.product:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(99,102,241,0.3); }
.product img { width: 100%; height: 200px; object-fit: cover; border-radius: 15px; margin-bottom: 1rem; }
.product h3 { font-size: 1.3rem; margin-bottom: 0.5rem; }
.product-brand { color: var(--primary); font-weight: bold; margin-bottom: 0.5rem; }
.product-desc { font-size: 0.9rem; margin-bottom: 1rem; opacity: 0.8; }
.product-price { font-size: 1.5rem; font-weight: bold; color: var(--accent); margin-bottom: 1rem; }
.add-cart { background: var(--accent); color: #000; border: none; padding: 0.8rem 2rem; border-radius: 50px; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s; }
.add-cart:hover { transform: scale(1.05); box-shadow: 0 10px 20px rgba(16,185,129,0.4); }
.category { display: none; }
.category.active { display: block; }
.category-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem; cursor: pointer; }
.cart-modal, .auth-modal, .checkout-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 200; backdrop-filter: blur(10px); }
.cart-modal.active, .auth-modal.active, .checkout-modal.active { display: flex; align-items: center; justify-content: center; }
.modal-content { background: var(--bg-card); padding: 2rem; border-radius: 20px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; position: relative; }
.close { position: absolute; top: 1rem; right: 1.5rem; font-size: 2rem; cursor: pointer; }
.cart-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
.cart-item-controls { display: flex; gap: 0.5rem; align-items: center; }
.qty-btn { background: var(--primary); border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; }
.remove { background: #ef4444; color: white; border: none; padding: 0.3rem 0.8rem; border-radius: 20px; cursor: pointer; }
.payment-methods { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1rem; }
.payment-method { display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgba(99,102,241,0.2); border-radius: 10px; cursor: pointer; }
.payment-method input { display: none; }
.payment-method input:checked + label { background: var(--primary); }
.delivery-address { display: none; margin-top: 1rem; }
.delivery-address input { width: 100%; padding: 1rem; border-radius: 10px; border: 1px solid var(--primary); background: var(--bg); color: var(--text); }
.order-btn { background: var(--accent); color: #000; border: none; padding: 1rem 2rem; border-radius: 50px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; }
.auth-form input { width: 100%; padding: 1rem; margin-bottom: 1rem; border-radius: 10px; border: 1px solid var(--primary); background: var(--bg); color: var(--text); }
@media (max-width: 768px) { 
    .products-grid { grid-template-columns: repeat(1, 1fr); } 
    nav ul { gap: 1rem; } 
    header { flex-direction: column; gap: 1rem; } }
</style>
</head>
<body>
<header>
    <div class="logo">TechCase</div>
    <nav>
        <ul>
            <li><a href="#" class="nav-link active" onclick="showCategory('all', event)">–í—Å–µ</a></li>
            <li><a href="#" class="nav-link" onclick="showCategory('cases', event)">üì± –ß–µ—Ö–ª—ã</a></li>
            <li><a href="#" class="nav-link" onclick="showCategory('chargers', event)">üîã –ó–∞—Ä—è–¥–∫–∏</a></li>
            <li><a href="#" class="nav-link" onclick="showCategory('protection', event)">üõ°Ô∏è –ó–∞—â–∏—Ç–∞</a></li>
            <li><a href="#" class="nav-link" onclick="showCategory('headphones', event)">üéß –ù–∞—É—à–Ω–∏–∫–∏</a></li>
            <li><a href="#" class="nav-link" onclick="showCategory('cables', event)">üîå –ö–∞–±–µ–ª–∏</a></li>
        </ul>
    </nav>
    <div class="auth-cart">
        <div id="authBtn" class="auth-btn" onclick="toggleAuth()">–í–æ–π—Ç–∏</div>
        <div class="cart-btn" onclick="toggleCart()">üõí <span id="cartCount">0</span></div>
        <div id="profile" class="profile" style="display:none;">üë§</div>
    </div>
</header>

<main>
    <div class="hero">
        <h1>Premium –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è –¢–µ–ª–µ—Ñ–æ–Ω–æ–≤</h1>
        <p>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—É ‚Ä¢ –õ—É—á—à–∏–µ –±—Ä–µ–Ω–¥—ã ‚Ä¢ –ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞</p>
    </div>
    <div id="productsContainer" class="products-grid"></div>
</main>

<!-- –ú–æ–¥–∞–ª–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
<div id="cartModal" class="cart-modal">
    <div class="modal-content">
        <span class="close" onclick="toggleCart()">&times;</span>
        <h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
        <div id="cartItems"></div>
        <div style="margin-top:2rem;">
            <h3>–ò—Ç–æ–≥–æ: <span id="totalPrice">0</span> ‚ÇΩ</h3>
            <button class="order-btn" onclick="toggleCheckout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
<div id="checkoutModal" class="checkout-modal">
    <div class="modal-content">
        <span class="close" onclick="toggleCheckout()">&times;</span>
        <h2>üì¶ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
        <div class="payment-methods">
            <label class="payment-method">
                <input type="radio" name="payment" value="sbp" checked>
                <span>üí≥ –°–ë–ü (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)</span>
            </label>
            <label class="payment-method">
                <input type="radio" name="payment" value="cash">
                <span>üí∞ –ù–∞–ª–∏—á–Ω—ã–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
            </label>
            <label class="payment-method">
                <input type="radio" name="payment" value="card">
                <span>üí≥ –ö–∞—Ä—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
            </label>
        </div>
        <div class="delivery-address">
            <input type="text" id="deliveryAddressInput" placeholder="–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–µ" />
        </div>
        <button class="order-btn" onclick="sendOrder()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
<div id="authModal" class="auth-modal">
    <div class="modal-content">
        <span class="close" onclick="toggleAuth()">&times;</span>
        <h2>üì± –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input type="text" id="userName" placeholder="–ò–º—è" />
        <input type="date" id="userBirthdate" placeholder="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è" />
        <input type="tel" id="userPhone" placeholder="+7 (___) ___-__-__" />
        <button class="order-btn" onclick="registerUser()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <div id="profileInfo" style="display:none; margin-top:1rem;">
            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="profileName"></span>!</p>
        </div>
    </div>
</div>

<!-- Firebase –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
<script type="module">
// –ò–º–ø–æ—Ä—Ç Firebase SDK
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
import { getAuth, signInWithPhoneNumber, RecaptchaVerifier } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyAaffnDJMEUCZg3ShkElM43T49EArakj0g",
    authDomain: "techcase-db.firebaseapp.com",
    projectId: "techcase-db",
    storageBucket: "techcase-db.appspot.com",
    messagingSenderId: "527907169282",
    appId: "1:527907169282:web:07847bdbfdd8d05ec4731b",
    measurementId: "G-CDY7FXV1WW"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const auth = getAuth(app);
const db = getFirestore(app);

window.confirmationResult = null;
let currentUser = null;

function initRecaptcha() {
  window.recaptchaVerifier = new RecaptchaVerifier('recaptcha-container', {}, auth);
  recaptchaVerifier.render();
}

window.addEventListener('load', () => {
  showCategory('all', { currentTarget: document.querySelector('.nav-link.active') || document.querySelector('.nav-link') });
  renderProducts();
  updateCartUI();
  loadUser();
  initRecaptcha();
});

// –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∏ (–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏)
const products = {
    cases: [
        { id: 1, name: "HOCO –ß–µ—Ö–æ–ª —Å–∏–ª–∏–∫–æ–Ω–æ–≤—ã–π", brand: "HOCO", desc: "–ú—è–≥–∫–∏–π TPU, –∞–Ω—Ç–∏—Å–∫–æ–ª—å–∑—è—â–∏–π, —É–¥–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π", price: 599, img: "https://images.unsplash.com/photo-1587563871167-29dce9c385aa?w=300" },
        { id: 2, name: "Baseus –ß–µ—Ö–æ–ª –º–∞–≥–Ω–∏—Ç–Ω—ã–π", brand: "Baseus", desc: "MagSafe —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π, –∫–∞—Ä–º–∞–Ω—ã –¥–ª—è –∫–∞—Ä—Ç", price: 1299, img: "https://images.unsplash.com/photo-1587563871167-29dce9c385aa?w=300" }
        // –¥–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    ],
    chargers: [
        { id: 101, name: "HOCO J141 Grace 10000mAh", brand: "HOCO", desc: "PD 20W, QC 18W, 2 –ø–æ—Ä—Ç–∞ USB", price: 2499, img: "https://images.unsplash.com/photo-1603302576837-37561b2e2302?w=300" }
        // –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    ],
    protection: [
        { id: 201, name: "Bro Glass 9H –∑–∞–∫–∞–ª–µ–Ω–Ω–æ–µ", brand: "Bro", desc: "–û–ª–µ–æ—Ñ–æ–±–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, 0.33–º–º", price: 799, img: "https://images.unsplash.com/photo-1517433456452-df7d5ee2c675?w=300" }
        // –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    ],
    headphones: [
        { id: 301, name: "Joyroom TWS Air", brand: "Joyroom", desc: "Bluetooth 5.3, 30—á –∞–≤—Ç–æ–Ω–æ–º–∏–∏", price: 2999, img: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=300" }
        // –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    ],
    cables: [
        { id: 401, name: "Baseus USB-C 1m 240W", brand: "Baseus", desc: "–ü–ª–µ—Ç–µ–Ω—ã–π, PD 240W, –±—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞", price: 999, img: "https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=300" }
        // –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    ]
};

function showCategory(category, event) {
    document.querySelectorAll('.nav-link').forEach(a => a.classList.remove('active'));
    event.currentTarget.classList.add('active');
    const container = document.getElementById('productsContainer');
    container.innerHTML = '';

    if (category === 'all') {
        Object.values(products).flat().forEach(p => {
            container.appendChild(createProductCard(p));
        });
    } else {
        products[category].forEach(p => {
            container.appendChild(createProductCard(p));
        });
    }
}

function createProductCard(p) {
    const card = document.createElement('div');
    card.className = 'product';
    card.innerHTML = `
        <img src="${p.img}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/300x200/6366f1/ffffff?text=${p.brand}'">
        <div class="product-brand">${p.brand}</div>
        <h3>${p.name}</h3>
        <p class="product-desc">${p.desc}</p>
        <div class="product-price">${p.price} ‚ÇΩ</div>
        <button class="add-cart" onclick="addToCart(${p.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
    `;
    return card;
}

function renderProducts() {
    showCategory('all', { currentTarget: document.querySelector('.nav-link.active') });
}

function addToCart(id) {
    const product = Object.values(products).flat().find(p => p.id === id);
    const item = cart.find(i => i.id === id);
    if (item) { item.qty++; }
    else { cart.push({ ...product, qty: 1 }); }
    localStorage.setItem('techcase_cart', JSON.stringify(cart));
    updateCartUI();
}

function updateCartUI() {
    document.getElementById('cartCount').textContent = cart.reduce((s, i) => s + i.qty, 0);
}

function toggleCart() {
    document.getElementById('cartModal').classList.toggle('active');
    renderCart();
}

function renderCart() {
    const el = document.getElementById('cartItems');
    const totalEl = document.getElementById('totalPrice');
    if (cart.length === 0) {
        el.innerHTML = '<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
        totalEl.textContent = '0';
        return;
    }
    el.innerHTML = cart.map(i => `
        <div class="cart-item">
            <span>${i.name} (${i.brand}) x <input type="number" value="${i.qty}" min="1" onchange="updateQty(${i.id}, this.value)" style="width:50px;"></span>
            <div class="cart-item-controls">
                <button class="qty-btn" onclick="updateQty(${i.id}, ${i.qty -1})">-</button>
                <span>${i.price * i.qty} ‚ÇΩ</span>
                <button class="qty-btn" onclick="updateQty(${i.id}, ${i.qty +1})">+</button>
                <button class="remove" onclick="removeFromCart(${i.id})">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    `).join('');
    totalEl.textContent = cart.reduce((s,i) => s + i.price * i.qty, 0);
}

function updateQty(id, qty) {
    qty = parseInt(qty);
    if (qty < 1) { removeFromCart(id); return; }
    const item = cart.find(i => i.id === id);
    if (item) { item.qty = qty; }
    localStorage.setItem('techcase_cart', JSON.stringify(cart));
    renderCart();
    updateCartUI();
}

function removeFromCart(id) {
    cart = cart.filter(i => i.id !== id);
    localStorage.setItem('techcase_cart', JSON.stringify(cart));
    renderCart();
    updateCartUI();
}

function toggleCheckout() {
    document.getElementById('checkoutModal').classList.toggle('active');
}

function toggleAuth() {
    document.getElementById('authModal').classList.toggle('active');
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage
let cart = JSON.parse(localStorage.getItem('techcase_cart')) || [];
let currentUser = null;
function loadUser() {
    const u = localStorage.getItem('techcase_user');
    if (u) {
        currentUser = JSON.parse(u);
        document.getElementById('profile').style.display = 'block';
        document.getElementById('authBtn').style.display = 'none';
        document.getElementById('profileName').textContent = currentUser.name;
        document.getElementById('profileInfo').style.display = 'block';
    }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞
async function sendOrder() {
    if (!currentUser) return alert('–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ!');
    const payment = document.querySelector('input[name="payment"]:checked').value;
    const address = document.getElementById('deliveryAddressInput').value;
    const total = cart.reduce((s,i) => s + i.price * i.qty, 0);
    const itemsText = cart.map(i => `${i.name} x${i.qty} (${i.price}‚ÇΩ)`).join('\n');
    // –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ telegram –∏–ª–∏ —á—Ç–æ –Ω—É–∂–Ω–æ
    await setDoc(doc(db, 'orders', Date.now().toString()), {
        user: currentUser,
        items: itemsText,
        total: total,
        payment: payment,
        address: payment !== 'sbp' ? address : '–°–∞–º–æ–≤—ã–≤–æ–∑',
        date: new Date().toLocaleString('ru-RU')
    });
    alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
    cart = [];
    localStorage.setItem('techcase_cart', JSON.stringify(cart));
    updateCartUI();
    toggleCheckout();
    toggleCart();
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, signInWithPhoneNumber, RecaptchaVerifier } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyAaffnDJMEUCZg3ShkElM43T49EArakj0g",
    authDomain: "techcase-db.firebaseapp.com",
    projectId: "techcase-db",
    storageBucket: "techcase-db.appspot.com",
    messagingSenderId: "527907169282",
    appId: "1:527907169282:web:07847bdbfdd8d05ec4731b",
    measurementId: "G-CDY7FXV1WW"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.confirmationResult = null;
function initRecaptcha() {
    window.recaptchaVerifier = new RecaptchaVerifier('recaptcha-container', {}, auth);
    recaptchaVerifier.render();
}
async function sendVerificationCode() {
    const phoneInput = document.getElementById('userPhone').value;
    const phone = '+7' + phoneInput.replace(/\D/g,'');
    try {
        window.confirmationResult = await signInWithPhoneNumber(auth, phone, window.recaptchaVerifier);
        alert('–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –í–≤–µ–¥–∏—Ç–µ –µ–≥–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.');
    } catch (e) {
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: '+ e.message);
    }
}
async function verifyCode() {
    const code = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –ø—Ä–∏—Å–ª–∞–Ω–Ω—ã–π –ø–æ SMS');
    try {
        await window.confirmationResult.confirm(code);
        alert('–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
        // –ú–æ–∂–Ω–æ –¥–∞–ª–µ–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    } catch (e) {
        alert('–û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: '+ e.message);
    }
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async function registerUser() {
    const name = document.getElementById('userName').value;
    const birthdate = document.getElementById('userBirthdate').value;
    const phone = document.getElementById('userPhone').value.replace(/\D/g, '');
    if (!name || !birthdate || phone.length < 10) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
    currentUser = { name, phone: '+7'+phone, birthdate };
    await setDoc(doc(db, 'users', phone), currentUser);
    document.getElementById('profileName').textContent = name;
    document.getElementById('profileInfo').style.display = 'block';
    document.getElementById('authBtn').style.display = 'none';
    document.getElementById('profile').style.display = 'block';
    toggleAuth();
    alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!');
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫
function toggleAuth() { document.getElementById('authModal').classList.toggle('active'); }
function toggleCart() { document.getElementById('cartModal').classList.toggle('active'); renderCart(); }
function toggleCheckout() { document.getElementById('checkoutModal').classList.toggle('active'); }

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage
loadUser();

</script>
<div id="recaptcha-container"></div>
</body>
</html>
